<html>
<body>
  <h2>PB CALC</h2>
  Cash (USD): <input value="100" id="cash"></input>
  <button onclick="main()">GO</button>
  <br></br>
  <div id="coins">
    OMG: <input value="6" id="OMG"></br>
    XRP: <input value="0.3" id="XRP"></br>
    ETC: <input value="25" id="ETC"></br>
    BTC: <input value="5000" id="BTC"></br> 
    ETH: <input value="400" id="ETH"></br> 
    XMR: <input value="60" id="XMR"></br> 
    NEO: <input value="2" id="NEO"></br> 
    GAS: <input value="30" id="GAS"></br> 
    STE: <input value="2.50" id="STEEM"></br>
    STO: <input value="0.50" id="STORJ"></br> 
    PPY: <input value="5" id="PPY"></br>
    FCT: <input value="50" id="FCT"></br>
    LKK: <input value="0.1" id="LKK"></br>
    ICN: <input value="1.25" id="ICN"></br>
    BTS: <input value="0.4" id="BTS"></br>
    MAID: <input value="0.5" id="MAID"></br>
    OMNI: <input value="60" id="OMNI"></br>
    DASH: <input value="140" id="DASH"></br>
    ANT: <input value="2.50" id="ANT"></br>
    XEM: <input value="0.30" id="XEM"></br> 
    WINGS: <input value="0.50" id="WINGS"></br>
    LSK: <input value="1.50" id="LSK"></br> 
    WAVES: <input value="4" id="WAVES"></br>
    BAT: <input value="0.35" id="BAT"></br> 
    SYS: <input value="0.3" id="SYS"></br> 
    XZC: <input value="20" id="XZC"></br> 
    GNT: <input value="0.6" id="GNT"></br>
  </div>
  <p id="output"></p>
  <script>
    function main(){var e=new XMLHttpRequest;e.open("GET","https://api.coinmarketcap.com/v1/ticker/?limit=200",!0),e.onload=function(){e.status>=200&&e.status<400?processData(JSON.parse(e.responseText)):console.log("We reached our target server, but it returned an error")},e.onerror=function(){console.log("There was a connection error of some sort")},e.send()}function processData(e){var t=parseFloat(e[0].price_usd),r=constructCoinList(e);renderBuyList(getBuyListHtml(sortList(getBuys(r,getTotalShare(r),t))),"output")}function constructCoinList(e){var t=[];return getLocalCoins().forEach(function(r){e.forEach(function(e){r.symbol==e.symbol&&(r.name=e.name,r.priceUsd=parseFloat(e.price_usd),r.upper>r.priceUsd&&(r.diff=(r.upper-r.priceUsd)/r.upper*100,t.push(r)))})}),t}function getLocalCoins(){var e=[],t=document.querySelectorAll("#coins input");return Array.prototype.forEach.call(t,function(t){var r={};r.symbol=t.id,r.upper=parseFloat(t.value),e.push(r)}),e}function getTotalShare(e){var t=[];return e.forEach(function(e){t.push(e.diff)}),t.reduce(function(e,t){return e+t},0)}function getBuys(e,t,r){var n=document.getElementById("cash").value,o=[];return e.forEach(function(e){e.share=e.diff/t,e.buy=e.share*n,e.buy_btc=e.buy/r,o.push({key:e.symbol,value:e.buy_btc})}),o}function sortList(e){return e.slice(0).sort(function(e,t){return t.value-e.value})}function getBuyListHtml(e){var t="";return e.forEach(function(e){t+=e.key+" = "+e.value+"<br/>"}),t}function renderBuyList(e,t){document.getElementById(t).innerHTML="",document.getElementById(t).innerHTML=e}
  </script>
</body>
</html>
